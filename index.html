<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>
    <title>Tom Gravity</title>
    <style>
        body {
            font-family: "Poppins", "verdana";
            color: white;
            background-color: rgb(30,30,30);
        }

        .horizontal {
            display: flex;
            flex-direction: row;
            margin-block: 1em;
        }

        h4 {
            margin-inline: 1em;
            margin-block: 0em
        }

        button {
            background-color: rgb(60,60,60);
            color: white;
            border-width: 0;
            margin-inline: 1em;
            font-family: "Poppins", "verdana";
            font-size:1em;
            padding:0.2em;
            padding-inline:0.4em;
        }
        .centered {
            justify-content: center;
        }
        .justified{justify-content:space-evenly;margin:0}
        .vertical {
            display: block;
            width:75%
        }
    </style>
</head>
<body style="text-align: center">
    
    <canvas id="unity-canvas" width=700 height=1080 style="width: 100%; height: 70vw; max-height: 80vh;   background: #1F1F20"></canvas>
    <div class="horizontal justified">
        <div style="padding:2em">
            <h1>Gravity Sim C#</h1>
        </div>
        <div class="vertical">
            <div class="horizontal centered">
                <button onclick="changeView();playifnot()">Toggle View</button>
                <button onclick="window.unityInstance.SendMessage('Main Camera', 'reset');playifnot()">Restart</button>
                <h4>&nbsp;</h4>
            </div>
            <div class="horizontal centered">
                <h4>Planets Velocity</h4>
                <button onclick="window.unityInstance.SendMessage('Sphere1', 'faster', 1);playifnot()">Increase</button>
                <button onclick="window.unityInstance.SendMessage('Sphere1', 'faster', -1);playifnot()">Decrease</button>
            </div>
            <div class="horizontal centered">
                <h4>Gravitational Strength</h4>
                <h4 id="gravityValueText">6</h4>
                <input style="width:50%" type="range" min="-50" max="50" value="6" id="gravityRange" oninput="changeGravity(this.value)">
                <button onclick="resetGravity()">Reset</button>
            </div>
            <div class="horizontal centered">
                <h4>Camera FOV</h4>
                <h4 id="FOVValueText">60</h4>
                <input style="width:50%" type="range" min="0" max="180" value="60" id="FOVrange" oninput="changeFOV(this.value)">
                <button onclick="resetFOV()">Reset</button>

            </div>
        </div>
    </div>

        <script src="Build/builds6.loader.js"></script>
        <script>
            if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
                // Mobile device style: fill the whole browser client area with the game canvas:
                var meta = document.createElement('meta');
                meta.name = 'viewport';
                meta.content = 'width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes';
                document.getElementsByTagName('head')[0].appendChild(meta);
            }

            createUnityInstance(document.querySelector("#unity-canvas"), {
                dataUrl: "Build/builds6.data.unityweb",
                frameworkUrl: "Build/builds6.framework.js.unityweb",
                codeUrl: "Build/builds6.wasm.unityweb",
                streamingAssetsUrl: "StreamingAssets",
                companyName: "DefaultCompany",
                productName: "My project (1)",
                productVersion: "1.0",
                // matchWebGLToCanvasSize: false, // Uncomment this to separately control WebGL canvas render size and DOM element size.
                // devicePixelRatio: 1, // Uncomment this to override low DPI rendering on high DPI displays.
            }).then((unityInstance) => {
                window.unityInstance = unityInstance;
            });


            audiolist = [
                "music/Dev Null and Tom McElhinney - Spicy Synthwave.mp3",
                "music/Tom McElhinney - New Orchestral Beginning.mp3",
                "music/Tom McElhinney - WB McGee - 01 WB McGee.mp3"
            ]


            var audio1
            var currentPlanet = 0

            function getsong() {
                rng = Math.floor(Math.random() * audiolist.length);
                audio1 = new Audio(audiolist[rng])
                audio1.addEventListener('ended', function () {
                    getsong(); audio1.play()
                })
            }
            getsong()



            function playifnot() {
                if (!audio1.played.length) {
                    audio1.play()
                }
            }

            document.getElementById("unity-canvas").addEventListener(onclick, playifnot)

            function changeGravity(val) {
                window.unityInstance.SendMessage('Sphere1', 'changeGravity', -val)
                window.unityInstance.SendMessage('Sphere2', 'changeGravity', -val)
                document.getElementById("gravityValueText").innerHTML = val
                playifnot()
            }

            function resetGravity() {
                document.getElementById("gravityRange").value = 6
                changeGravity(6)
            }

            function changeFOV(val) {
                window.unityInstance.SendMessage('Main Camera', 'changeFOV', parseInt(val))
                document.getElementById("FOVValueText").innerHTML = val
                playifnot()
            }

            function resetFOV() {
                document.getElementById("FOVrange").value = 60
                changeFOV(60)
            }

            function changeView() {
                playifnot()
                currentPlanet = (currentPlanet + 1) % 3
                window.unityInstance.SendMessage('Main Camera', 'changeView', `${currentPlanet + 1}`)
            }
        </script>
</body>
</html>
